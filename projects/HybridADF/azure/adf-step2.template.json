{
    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "location": {
            "type": "string",
            "defaultValue": "[resourceGroup().location]",
            "metadata": {
                "displayName": "Azure region",
                "description": "The Azure region within which to deploy. Examples: 'eastus', 'eastus2', and so on. See https://azure.microsoft.com/en-us/global-infrastructure/services/?products=data-factory for the current list of Azure regions in which Data Factory is available."
            }
        },
        "factory_name": {
            "type": "string",
            "metadata": {
                "description": "Data Factory Name"
            }
        },
        "integration_runtime_name": {
            "type": "string",
            "metadata": {
                "description": "Integration Runtime Name"
            }
        },
        "azure_ad_tenant_id": {
            "type": "string",
            "metadata": {
                "description": "Azure AD Tenant ID (GUID) where Service Principals are defined"
            }
        },
        "azure_service_principal_id": {
            "type": "string",
            "metadata": {
                "description": "Service Principal ID (GUID)"
            }
        },
        "azure_service_principal_key": {
            "type": "securestring",
            "metadata": {
                "description": "Service Principal Key (Password)"
            }
        },
        "azure_storage_account_name": {
            "type": "string"
        },
        "azure_container_name_staging_ref": {
            "type": "string"
        },
        "azure_container_name_staging_tx": {
            "type": "string"
        },
        "azure_sql_server_name_ref_data": {
            "type": "string"
        },
        "azure_sql_server_name_tx_prod_data": {
            "type": "string"
        },
        "azure_sql_server_name_tx_staging_data": {
            "type": "string"
        },
        "azure_sql_database_name_ref_data": {
            "type": "string"
        },
        "azure_sql_database_name_tx_prod_data": {
            "type": "string"
        },
        "azure_sql_database_name_tx_staging_data": {
            "type": "string"
        },
        "on_prem_sql_server_name_ref_data": {
            "type": "string"
        },
        "on_prem_sql_server_name_tx_data": {
            "type": "string"
        },
        "on_prem_sql_database_name_ref_data": {
            "type": "string"
        },
        "on_prem_sql_database_name_tx_data": {
            "type": "string"
        },
        "on_prem_sql_username_ref_data": {
            "type": "string"
        },
        "on_prem_sql_username_tx_data": {
            "type": "string"
        },
        "on_prem_sql_password_ref_data": {
            "type": "securestring"
        },
        "on_prem_sql_password_tx_data": {
            "type": "securestring"
        }
    },
    "variables": {
        "api_version": "2018-06-01",
        "factory_id": "[concat('Microsoft.DataFactory/factories/', parameters('factory_name'))]",
        "integration_runtime_id": "[concat(variables('factory_id'), '/integrationRuntimes/', parameters('integration_runtime_name'))]",
        "azure_service_endpoint_storage": "[concat('https://', parameters('azure_storage_account_name'), '.blob.core.windows.net')]",
        "linked_service_name_azure_ref_data": "azure_ref_data",
        "linked_service_name_azure_ref_storage": "azure_ref_storage",
        "linked_service_name_azure_tx_prod_data": "azure_tx_prod_data",
        "linked_service_name_azure_tx_staging_data": "azure_tx_staging_data",
        "linked_service_name_azure_tx_storage": "azure_tx_storage",
        "linked_service_name_on_prem_ref_data": "on_prem_ref_data",
        "linked_service_name_on_prem_tx_data": "on_prem_tx_data",
        "linked_service_id_azure_ref_data": "[concat(variables('factory_id'), '/linkedServices/', variables('linked_service_name_azure_ref_data'))]",
        "linked_service_id_azure_ref_storage": "[concat(variables('factory_id'), '/linkedServices/', variables('linked_service_name_azure_ref_storage'))]",
        "linked_service_id_azure_tx_prod_data": "[concat(variables('factory_id'), '/linkedServices/', variables('linked_service_name_azure_tx_prod_data'))]",
        "linked_service_id_azure_tx_staging_data": "[concat(variables('factory_id'), '/linkedServices/', variables('linked_service_name_azure_tx_staging_data'))]",
        "linked_service_id_azure_tx_storage": "[concat(variables('factory_id'), '/linkedServices/', variables('linked_service_name_azure_tx_storage'))]",
        "linked_service_id_on_prem_ref_data": "[concat(variables('factory_id'), '/linkedServices/', variables('linked_service_name_on_prem_ref_data'))]",
        "linked_service_id_on_prem_tx_data": "[concat(variables('factory_id'), '/linkedServices/', variables('linked_service_name_on_prem_tx_data'))]",
        "pipeline_name_ref_full": "ref_full",
        "pipeline_name_ref_incremental": "ref_incremental",
        "pipeline_name_tx_onprem_to_staging_full": "tx_onprem_to_staging_full",
        "pipeline_name_tx_onprem_to_staging_incremental": "tx_onprem_to_staging_incremental",
        "pipeline_name_tx_staging_to_prod_full": "tx_staging_to_prod_full",
        "pipeline_name_tx_staging_to_prod_incremental": "tx_staging_to_prod_incremental",
        "azure_ingest_delete_file_name": "*",
        "azure_ingest_delete_log_folder": "/deleted/",
        "azure_ingest_delete_folder_path_location_types": "location-types/ingest",
        "azure_ingest_delete_container_path_location_types": "[concat(parameters('azure_container_name_staging_ref'), '/', variables('azure_ingest_delete_folder_path_location_types'))]",
        "azure_ingest_delete_folder_path_locations": "locations/ingest",
        "azure_ingest_delete_container_path_locations": "[concat(parameters('azure_container_name_staging_ref'), '/', variables('azure_ingest_delete_folder_path_locations'))]",
        "azure_ingest_delete_folder_path_stores": "stores/ingest",
        "azure_ingest_delete_container_path_stores": "[concat(parameters('azure_container_name_staging_ref'), '/', variables('azure_ingest_delete_folder_path_stores'))]",
        "azure_ingest_delete_folder_path_tx_types": "tx-types/ingest",
        "azure_ingest_delete_container_path_tx_types": "[concat(parameters('azure_container_name_staging_ref'), '/', variables('azure_ingest_delete_folder_path_tx_types'))]",
        "azure_ingest_delete_folder_path_tx_lines": "transaction-lines/ingest",
        "azure_ingest_delete_container_path_tx_lines": "[concat(parameters('azure_container_name_staging_tx'), '/', variables('azure_ingest_delete_folder_path_tx_lines'))]",
        "azure_ingest_delete_folder_path_txs": "transactions/ingest",
        "azure_ingest_delete_container_path_txs": "[concat(parameters('azure_container_name_staging_tx'), '/', variables('azure_ingest_delete_folder_path_txs'))]",
        "connection_string_azure_ref_data": "[concat('integrated security=False;encrypt=True;connection timeout=30;data source=', parameters('azure_sql_server_name_ref_data'), '.database.windows.net;initial catalog=', parameters('azure_sql_database_name_ref_data'))]",
        "connection_string_azure_tx_prod_data": "[concat('integrated security=False;encrypt=True;connection timeout=30;data source=', parameters('azure_sql_server_name_tx_prod_data'), '.database.windows.net;initial catalog=', parameters('azure_sql_database_name_tx_prod_data'))]",
        "connection_string_azure_tx_staging_data": "[concat('integrated security=False;encrypt=True;connection timeout=30;data source=', parameters('azure_sql_server_name_tx_staging_data'), '.database.windows.net;initial catalog=', parameters('azure_sql_database_name_tx_staging_data'))]",
        "connection_string_on_prem_ref_data": "[concat('integrated security=False;data source=', parameters('on_prem_sql_server_name_ref_data'), ';initial catalog=', parameters('on_prem_sql_database_name_ref_data'), ';user id=', parameters('on_prem_sql_username_ref_data'), ';password=', parameters('on_prem_sql_password_ref_data'))]",
        "connection_string_on_prem_tx_data": "[concat('integrated security=False;data source=', parameters('on_prem_sql_server_name_tx_data'), ';initial catalog=', parameters('on_prem_sql_database_name_tx_data'), ';user id=', parameters('on_prem_sql_username_tx_data'), ';password=', parameters('on_prem_sql_password_tx_data'))]",
        "dataset_az_db_r_location_types": "az_db_r_location_types",
        "dataset_az_db_r_location_types_ingest": "az_db_r_location_types_ingest",
        "dataset_az_db_r_locations": "az_db_r_locations",
        "dataset_az_db_r_locations_ingest": "az_db_r_locations_ingest",
        "dataset_az_db_r_stores": "az_db_r_stores",
        "dataset_az_db_r_stores_ingest": "az_db_r_stores_ingest",
        "dataset_az_db_r_tx_types": "az_db_r_tx_types",
        "dataset_az_db_r_tx_types_ingest": "az_db_r_tx_types_ingest",
        "dataset_az_db_ts_tx_lines": "az_db_ts_tx_lines",
        "dataset_az_db_ts_tx_lines_ingest": "az_db_ts_tx_lines_ingest",
        "dataset_az_db_ts_txs": "az_db_ts_txs",
        "dataset_az_db_ts_txs_ingest": "az_db_ts_txs_ingest",
        "dataset_az_db_tp_tx_lines": "az_db_tp_tx_lines",
        "dataset_az_db_tp_tx_lines_ingest": "az_db_tp_tx_lines_ingest",
        "dataset_az_db_tp_txs": "az_db_tp_txs",
        "dataset_az_db_tp_txs_ingest": "az_db_tp_txs_ingest",
        "dataset_az_st_r_location_types": "az_st_r_location_types",
        "dataset_az_st_r_location_types_ingest": "az_st_r_location_types_ingest",
        "dataset_az_st_r_location_types_ingest_delete": "az_st_r_location_types_ingest_delete",
        "dataset_az_st_r_locations": "az_st_r_locations",
        "dataset_az_st_r_locations_ingest": "az_st_r_locations_ingest",
        "dataset_az_st_r_locations_ingest_delete": "az_st_r_locations_ingest_delete",
        "dataset_az_st_r_stores": "az_st_r_stores",
        "dataset_az_st_r_stores_ingest": "az_st_r_stores_ingest",
        "dataset_az_st_r_stores_ingest_delete": "az_st_r_stores_ingest_delete",
        "dataset_az_st_r_tx_types": "az_st_r_tx_types",
        "dataset_az_st_r_tx_types_ingest": "az_st_r_tx_types_ingest",
        "dataset_az_st_r_tx_types_ingest_delete": "az_st_r_tx_types_ingest_delete",
        "dataset_az_st_t_tx_lines": "az_st_t_tx_lines",
        "dataset_az_st_t_tx_lines_ingest": "az_st_t_tx_lines_ingest",
        "dataset_az_st_t_tx_lines_ingest_delete": "az_st_t_tx_lines_ingest_delete",
        "dataset_az_st_t_txs": "az_st_t_txs",
        "dataset_az_st_t_txs_ingest": "az_st_t_txs_ingest",
        "dataset_az_st_t_txs_ingest_delete": "az_st_t_txs_ingest_delete",
        "dataset_op_db_r_location_types": "op_db_r_location_types",
        "dataset_op_db_r_locations": "op_db_r_locations",
        "dataset_op_db_r_stores": "op_db_r_stores",
        "dataset_op_db_r_tx_types": "op_db_r_tx_types",
        "dataset_op_db_t_tx_lines": "op_db_t_tx_lines",
        "dataset_op_db_t_txs": "op_db_t_txs"
    },
    "resources": [
        {
            "name": "[parameters('factory_name')]",
            "type": "Microsoft.DataFactory/factories",
            "apiVersion": "[variables('api_version')]",
            "location": "[parameters('location')]",
            "identity": {
                "type": "SystemAssigned"
            }
        },
        {
            "name": "[concat(parameters('factory_name'), '/', parameters('integration_runtime_name'))]",
            "type": "Microsoft.DataFactory/factories/integrationRuntimes",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "type": "SelfHosted",
                "typeProperties": {}
            },
            "dependsOn": [
                "[variables('factory_id')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('linked_service_name_azure_ref_data'))]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "annotations": [],
                "type": "AzureSqlDatabase",
                "typeProperties": {
                    "connectionString": "[variables('connection_string_azure_ref_data')]",
                    "servicePrincipalId": "[parameters('azure_service_principal_id')]",
                    "servicePrincipalKey": {
                        "type": "SecureString",
                        "value": "[parameters('azure_service_principal_key')]"
                    },
                    "tenant": "[parameters('azure_ad_tenant_id')]"
                }
            },
            "dependsOn": [
                "[variables('factory_id')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('linked_service_name_azure_ref_storage'))]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "annotations": [],
                "type": "AzureBlobStorage",
                "typeProperties": {
                    "serviceEndpoint": "[variables('azure_service_endpoint_storage')]",
                    "tenant": "[parameters('azure_ad_tenant_id')]",
                    "servicePrincipalId": "[parameters('azure_service_principal_id')]",
                    "servicePrincipalKey": {
                        "type": "SecureString",
                        "value": "[parameters('azure_service_principal_key')]"
                    }
                }
            },
            "dependsOn": [
                "[variables('factory_id')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('linked_service_name_azure_tx_prod_data'))]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "annotations": [],
                "type": "AzureSqlDatabase",
                "typeProperties": {
                    "connectionString": "[variables('connection_string_azure_tx_prod_data')]",
                    "servicePrincipalId": "[parameters('azure_service_principal_id')]",
                    "servicePrincipalKey": {
                        "type": "SecureString",
                        "value": "[parameters('azure_service_principal_key')]"
                    },
                    "tenant": "[parameters('azure_ad_tenant_id')]"
                }
            },
            "dependsOn": [
                "[variables('factory_id')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('linked_service_name_azure_tx_staging_data'))]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "annotations": [],
                "type": "AzureSqlDatabase",
                "typeProperties": {
                    "connectionString": "[variables('connection_string_azure_tx_staging_data')]",
                    "servicePrincipalId": "[parameters('azure_service_principal_id')]",
                    "servicePrincipalKey": {
                        "type": "SecureString",
                        "value": "[parameters('azure_service_principal_key')]"
                    },
                    "tenant": "[parameters('azure_ad_tenant_id')]"
                }
            },
            "dependsOn": [
                "[variables('factory_id')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('linked_service_name_azure_tx_storage'))]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "annotations": [],
                "type": "AzureBlobStorage",
                "typeProperties": {
                    "serviceEndpoint": "[variables('azure_service_endpoint_storage')]",
                    "tenant": "[parameters('azure_ad_tenant_id')]",
                    "servicePrincipalId": "[parameters('azure_service_principal_id')]",
                    "servicePrincipalKey": {
                        "type": "SecureString",
                        "value": "[parameters('azure_service_principal_key')]"
                    }
                }
            },
            "dependsOn": [
                "[variables('factory_id')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('linked_service_name_on_prem_ref_data'))]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "annotations": [],
                "type": "SqlServer",
                "typeProperties": {
                    "connectionString": "[variables('connection_string_on_prem_ref_data')]"
                },
                "connectVia": {
                    "referenceName": "[parameters('integration_runtime_name')]",
                    "type": "IntegrationRuntimeReference"
                }
            },
            "dependsOn": [
                "[variables('integration_runtime_id')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('linked_service_name_on_prem_tx_data'))]",
            "type": "Microsoft.DataFactory/factories/linkedServices",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "annotations": [],
                "type": "SqlServer",
                "typeProperties": {
                    "connectionString": "[variables('connection_string_on_prem_tx_data')]"
                },
                "connectVia": {
                    "referenceName": "[parameters('integration_runtime_name')]",
                    "type": "IntegrationRuntimeReference"
                }
            },
            "dependsOn": [
                "[variables('integration_runtime_id')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('pipeline_name_ref_full'))]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "activities": [
                    {
                        "name": "location_types_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "ref_prep_ingest_full",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_type_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "location_type_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_r_location_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_location_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "locations_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "ref_prep_ingest_full",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "location_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "address_1",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "address_1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "address_2",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "address_2",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "address_3",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "address_3",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "locality",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "locality",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "postal_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "postal_code",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "state_province",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "state_province",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "latitude",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "latitude",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "longitude",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "longitude",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_r_locations')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_locations')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "stores_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "ref_prep_ingest_full",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "store_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "store_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_r_stores')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_stores')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "tx_types_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "ref_prep_ingest_full",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_type_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "tx_type_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_r_tx_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_tx_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "ref_prep_ingest_full",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[prep_ingest_full]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "location_types_storage_to_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "location_types_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_location_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_location_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "locations_storage_to_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "locations_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_locations')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_locations_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "stores_storage_to_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "stores_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_stores')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_stores_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "tx_types_storage_to_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_types_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_tx_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_tx_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "location_types_ingest_storage_to_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "location_types_storage_to_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_type_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "location_type_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_location_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_r_location_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "locations_ingest_storage_to_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "locations_storage_to_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "location_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "address_1",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "address_1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "address_2",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "address_2",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "address_3",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "address_3",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "locality",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "locality",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "postal_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "postal_code",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "state_province",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "state_province",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "latitude",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "latitude",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "longitude",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "longitude",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_locations_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_r_locations')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "stores_ingest_storage_to_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "stores_storage_to_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "store_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "store_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_stores_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_r_stores')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "tx_types_ingest_storage_to_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_types_storage_to_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_type_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "tx_type_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_tx_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_r_tx_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "delete_location_types_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "location_types_ingest_storage_to_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_r_location_types_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_location_types'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    },
                    {
                        "name": "delete_locations_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "locations_ingest_storage_to_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_r_locations_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_locations'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    },
                    {
                        "name": "delete_stores_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "stores_ingest_storage_to_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_r_stores_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_stores'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    },
                    {
                        "name": "delete_tx-types_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "tx_types_ingest_storage_to_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_r_tx_types_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_tx_types'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    }
                ],
                "annotations": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]",
                "[variables('linked_service_id_azure_ref_storage')]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_r_location_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_location_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_r_locations'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_locations'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_r_stores'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_stores'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_r_tx_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_tx_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_location_types_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_locations_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_stores_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_tx_types_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_location_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_locations'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_stores'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_tx_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_location_types_ingest_delete'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_locations_ingest_delete'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_stores_ingest_delete'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_tx_types_ingest_delete'))]"
            ]
        },


        {
            "name": "[concat(parameters('factory_name'), '/', variables('pipeline_name_tx_staging_to_prod_incremental'))]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "activities": [
                    {
                        "name": "tx_lines_prod_max_date",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_tx_lines_max_date]"
                            },
                            "dataset": {
                                "referenceName": "[variables('dataset_az_db_tp_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "tx_lines_staging_to_prod",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_prod_max_date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_tx_lines_incremental]",
                                "storedProcedureParameters": {
                                    "min_date": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@{activity('tx_lines_prod_max_date').output.firstRow.max_date}",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sku",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "sku",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_ts_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_tp_tx_lines_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "txs_prod_max_date",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_txs_max_date]"
                            },
                            "dataset": {
                                "referenceName": "[variables('dataset_az_db_tp_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "txs_staging_to_prod",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "txs_prod_max_date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_txs_incremental]",
                                "storedProcedureParameters": {
                                    "min_date": {
                                        "type": "DateTime",
                                        "value": {
                                            "value": "@{activity('txs_prod_max_date').output.firstRow.max_date}",
                                            "type": "Expression"
                                        }
                                    }
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_ts_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_tp_txs_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "db_tp_ingest_tx_lines",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_staging_to_prod",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[ingest_tx_lines]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_tx_prod_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "db_tp_ingest_txs",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "txs_staging_to_prod",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[ingest_txs]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_tx_prod_data')]",
                            "type": "LinkedServiceReference"
                        }
                    }
                ]
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_staging_data')]",
                "[variables('linked_service_id_azure_tx_prod_data')]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_ts_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_tp_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_tp_tx_lines_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_ts_txs'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_tp_txs'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_tp_txs_ingest'))]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('pipeline_name_tx_staging_to_prod_full'))]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "activities": [
                    {
                        "name": "prod_prep_ingest_full",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[prep_ingest_full]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_tx_prod_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "tx_lines_staging_to_prod",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "prod_prep_ingest_full",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sku",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "sku",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_ts_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_tp_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "txs_staging_to_prod",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "prod_prep_ingest_full",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource"
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_ts_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_tp_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    }
                ]
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_staging_data')]",
                "[variables('linked_service_id_azure_tx_prod_data')]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_ts_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_tp_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_ts_txs'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_tp_txs'))]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('pipeline_name_tx_onprem_to_staging_full'))]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "activities": [
                    {
                        "name": "tx_lines_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "staging_prep_ingest_full",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sku",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "sku",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_t_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "txs_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "staging_prep_ingest_full",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource"
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_t_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "tx_lines_storage_to_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "txs_storage_to_staging_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "txs_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting",
                                    "recursive": true,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_txs_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "tx_lines_ingest_storage_to_staging_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_storage_to_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting",
                                    "recursive": false,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sku",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "sku",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_ts_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "txs_ingest_storage_to_staging_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "txs_storage_to_staging_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting",
                                    "recursive": false,
                                    "enablePartitionDiscovery": false
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_txs_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_ts_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "staging_prep_ingest_full",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[prep_ingest_full]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_tx_staging_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "delete_tx_lines_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_ingest_storage_to_staging_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_tx_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_tx_lines'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    },
                    {
                        "name": "delete_txs_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "txs_ingest_storage_to_staging_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_t_txs_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_tx_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_txs'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    }
                ],
                "annotations": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_staging_data')]",
                "[variables('linked_service_id_azure_tx_storage')]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_t_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_t_txs'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_txs'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_tx_lines_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_txs_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_ts_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_ts_txs'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_tx_lines_ingest_delete'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_txs_ingest_delete'))]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('pipeline_name_tx_onprem_to_staging_incremental'))]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "activities": [
                    {
                        "name": "tx_lines_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_max_date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT tx_item_guid, tx_guid, tx_type_id, sku, qty, unit_amt, date_created, date_updated FROM data.transaction_lines WHERE date_created > '@{activity('tx_lines_max_date').output.firstRow.max_date}' OR date_updated > '@{activity('tx_lines_max_date').output.firstRow.max_date}';",
                                    "type": "Expression"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sku",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "sku",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_t_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "txs_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "txs_max_date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT tx_guid, date_tx, store_id, date_created, date_updated FROM data.transactions WHERE date_created > '@{activity('txs_max_date').output.firstRow.max_date}' OR date_updated > '@{activity('txs_max_date').output.firstRow.max_date}';",
                                    "type": "Expression"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_t_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "tx_lines_max_date",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_tx_lines_max_date]"
                            },
                            "dataset": {
                                "referenceName": "[variables('dataset_az_db_ts_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "txs_max_date",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_txs_max_date]"
                            },
                            "dataset": {
                                "referenceName": "[variables('dataset_az_db_ts_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "tx_lines_storage_to_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "txs_ingest_storage_to_staging_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "txs_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_txs')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_txs_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "tx_lines_storage_to_db_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_storage_to_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_item_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "sku",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "sku",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "qty",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "unit_amt",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_ts_tx_lines_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "txs_storage_to_db_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "txs_ingest_storage_to_staging_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        },
                                        "sink": {
                                            "name": "tx_guid",
                                            "type": "Guid"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_tx",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_t_txs_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_ts_txs_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "db_ts_ingest_tx_lines",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[ingest_tx_lines]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_tx_staging_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "db_ts_ingest_txs",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "txs_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[ingest_txs]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_tx_staging_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "delete_tx_lines_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "tx_lines_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_t_tx_lines_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_tx_lines'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    },
                    {
                        "name": "delete_txs_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "txs_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_t_txs_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_txs'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    }
                ],
                "annotations": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_staging_data')]",
                "[variables('linked_service_id_azure_ref_storage')]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_t_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_t_txs'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_txs'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_ts_tx_lines'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_tx_lines_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_txs_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_ts_tx_lines_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_ts_txs_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_tx_lines_ingest_delete'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_t_txs_ingest_delete'))]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('pipeline_name_ref_incremental'))]",
            "type": "Microsoft.DataFactory/factories/pipelines",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "activities": [
                    {
                        "name": "location_types_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "location_types_max_date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT location_type_id, location_type_name, date_start, date_end, is_deleted, date_created, date_updated FROM data.location_types WHERE date_created > '@{activity('location_types_max_date').output.firstRow.max_date}' OR date_updated > '@{activity('location_types_max_date').output.firstRow.max_date}';",
                                    "type": "Expression"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_r_location_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_location_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "locations_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "locations_max_date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT location_id, location_type_id, location_name, address_1, address_2, address_3, locality, postal_code, state_province, country, latitude, longitude, date_start, date_end, is_deleted, date_created, date_updated FROM data.locations WHERE date_created > '@{activity('locations_max_date').output.firstRow.max_date}' OR date_updated > '@{activity('locations_max_date').output.firstRow.max_date}';",
                                    "type": "Expression"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_r_locations')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_locations')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "location_types_max_date",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_location_types_max_date]"
                            },
                            "dataset": {
                                "referenceName": "[variables('dataset_az_db_r_location_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "locations_max_date",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_locations_max_date]"
                            },
                            "dataset": {
                                "referenceName": "[variables('dataset_az_db_r_locations')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "location_types_storage_to_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "location_types_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_location_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_location_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "locations_ingest_storage_to_staging_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "locations_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_locations')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_locations_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "location_types_storage_to_db_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "location_types_storage_to_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_type_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "location_type_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_location_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_r_location_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "locations_storage_to_db_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "locations_ingest_storage_to_staging_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "location_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "address_1",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "address_1",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "address_2",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "address_2",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "address_3",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "address_3",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "locality",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "locality",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "postal_code",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "postal_code",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "state_province",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "state_province",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "country",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "country",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "latitude",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "latitude",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "longitude",
                                            "type": "Decimal"
                                        },
                                        "sink": {
                                            "name": "longitude",
                                            "type": "Decimal"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_locations_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_r_locations_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "db_r_ingest_location_types",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "location_types_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[ingest_location_types]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "db_r_ingest_locations",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "locations_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[ingest_locations]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "delete_location_types_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "location_types_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_r_location_types_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_location_types'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    },
                    {
                        "name": "delete_locations_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "locations_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_r_locations_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_locations'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    },
                    {
                        "name": "stores_max_date",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_stores_max_date]"
                            },
                            "dataset": {
                                "referenceName": "[variables('dataset_az_db_r_stores')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "stores_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "stores_max_date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT store_id, location_id, store_name, date_start, date_end, is_deleted, date_created, date_updated FROM data.stores WHERE date_created > '@{activity('stores_max_date').output.firstRow.max_date}' OR date_updated > '@{activity('stores_max_date').output.firstRow.max_date}';",
                                    "type": "Expression"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_r_stores')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_stores')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "stores_ingest_storage_to_staging_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "stores_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_stores')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_stores_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "stores_storage_to_db_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "stores_ingest_storage_to_staging_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "store_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "location_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "store_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "store_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_stores_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_r_stores_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "db_r_ingest_stores",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "stores_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[ingest_stores]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "delete_stores_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "stores_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_r_stores_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_stores'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    },
                    {
                        "name": "tx_types_max_date",
                        "type": "Lookup",
                        "dependsOn": [],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "AzureSqlSource",
                                "sqlReaderStoredProcedureName": "[[data].[get_tx_types_max_date]"
                            },
                            "dataset": {
                                "referenceName": "[variables('dataset_az_db_r_tx_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        }
                    },
                    {
                        "name": "tx_types_onprem_to_storage",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_types_max_date",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "SqlServerSource",
                                "sqlReaderQuery": {
                                    "value": "SELECT tx_type_id, tx_type_name, date_start, date_end, is_deleted, date_created, date_updated FROM data.tx_types WHERE date_created > '@{activity('tx_types_max_date').output.firstRow.max_date}' OR date_updated > '@{activity('tx_types_max_date').output.firstRow.max_date}';",
                                    "type": "Expression"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_op_db_r_tx_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_tx_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "tx_types_ingest_storage_to_staging_db",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_types_onprem_to_storage",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "DelimitedTextSink",
                                "storeSettings": {
                                    "type": "AzureBlobStorageWriteSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextWriteSetting",
                                    "quoteAllText": true,
                                    "fileExtension": ".csv"
                                }
                            },
                            "enableStaging": false
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_tx_types')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_tx_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "tx_types_storage_to_db_ingest",
                        "type": "Copy",
                        "dependsOn": [
                            {
                                "activity": "tx_types_ingest_storage_to_staging_db",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "source": {
                                "type": "DelimitedTextSource",
                                "storeSettings": {
                                    "type": "AzureBlobStorageReadSetting"
                                },
                                "formatSettings": {
                                    "type": "DelimitedTextReadSetting"
                                }
                            },
                            "sink": {
                                "type": "AzureSqlSink"
                            },
                            "enableStaging": false,
                            "translator": {
                                "type": "TabularTranslator",
                                "mappings": [
                                    {
                                        "source": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        },
                                        "sink": {
                                            "name": "tx_type_id",
                                            "type": "Int32"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "tx_type_name",
                                            "type": "String"
                                        },
                                        "sink": {
                                            "name": "tx_type_name",
                                            "type": "String"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_start",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_end",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        },
                                        "sink": {
                                            "name": "is_deleted",
                                            "type": "Boolean"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_created",
                                            "type": "DateTime"
                                        }
                                    },
                                    {
                                        "source": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        },
                                        "sink": {
                                            "name": "date_updated",
                                            "type": "DateTime"
                                        }
                                    }
                                ]
                            }
                        },
                        "inputs": [
                            {
                                "referenceName": "[variables('dataset_az_st_r_tx_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ],
                        "outputs": [
                            {
                                "referenceName": "[variables('dataset_az_db_r_tx_types_ingest')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            }
                        ]
                    },
                    {
                        "name": "db_r_ingest_tx_types",
                        "type": "SqlServerStoredProcedure",
                        "dependsOn": [
                            {
                                "activity": "tx_types_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "storedProcedureName": "[[data].[ingest_tx_types]"
                        },
                        "linkedServiceName": {
                            "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                            "type": "LinkedServiceReference"
                        }
                    },
                    {
                        "name": "delete_tx_types_ingest_storage",
                        "type": "Delete",
                        "dependsOn": [
                            {
                                "activity": "tx_types_storage_to_db_ingest",
                                "dependencyConditions": [
                                    "Succeeded"
                                ]
                            }
                        ],
                        "policy": {
                            "timeout": "7.00:00:00",
                            "retry": 0,
                            "retryIntervalInSeconds": 30,
                            "secureOutput": false,
                            "secureInput": false
                        },
                        "userProperties": [],
                        "typeProperties": {
                            "dataset": {
                                "referenceName": "[variables('dataset_az_st_r_tx_types_ingest_delete')]",
                                "type": "DatasetReference",
                                "parameters": {}
                            },
                            "recursive": true,
                            "logStorageSettings": {
                                "linkedServiceName": {
                                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                                    "type": "LinkedServiceReference"
                                },
                                "path": "[concat(variables('azure_ingest_delete_container_path_tx_types'), variables('azure_ingest_delete_log_folder'))]"
                            },
                            "enableLogging": true
                        }
                    }
                ],
                "annotations": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]",
                "[variables('linked_service_id_azure_ref_storage')]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_r_location_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_location_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_r_locations'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_locations'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_location_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_locations'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_location_types_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_locations_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_location_types_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_locations_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_location_types_ingest_delete'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_locations_ingest_delete'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_stores'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_r_stores'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_stores'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_stores_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_stores_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_stores_ingest_delete'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_tx_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_op_db_r_tx_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_tx_types'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_tx_types_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_db_r_tx_types_ingest'))]",
                "[concat(variables('factory_id'), '/datasets/', variables('dataset_az_st_r_tx_types_ingest_delete'))]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_r_location_types'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "location_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_type_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[location_types]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_r_locations'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "location_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "address_1",
                        "type": "nvarchar"
                    },
                    {
                        "name": "address_2",
                        "type": "nvarchar"
                    },
                    {
                        "name": "address_3",
                        "type": "nvarchar"
                    },
                    {
                        "name": "locality",
                        "type": "nvarchar"
                    },
                    {
                        "name": "postal_code",
                        "type": "nvarchar"
                    },
                    {
                        "name": "state_province",
                        "type": "nvarchar"
                    },
                    {
                        "name": "country",
                        "type": "nvarchar"
                    },
                    {
                        "name": "latitude",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 8
                    },
                    {
                        "name": "longitude",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 8
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[locations]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_r_stores'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "store_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "store_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[stores]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_r_tx_types'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "tx_type_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[tx_types]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_ts_tx_lines'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_staging_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_item_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "sku",
                        "type": "nvarchar"
                    },
                    {
                        "name": "qty",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "unit_amt",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transaction_lines]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_staging_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_ts_tx_lines_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_staging_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_item_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "sku",
                        "type": "nvarchar"
                    },
                    {
                        "name": "qty",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "unit_amt",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transaction_lines_ingest]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_staging_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_ts_txs'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_staging_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "date_tx",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "store_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transactions]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_staging_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_ts_txs_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_staging_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "date_tx",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "store_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transactions_ingest]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_staging_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_tp_tx_lines'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_prod_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_item_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "sku",
                        "type": "nvarchar"
                    },
                    {
                        "name": "qty",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "unit_amt",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transaction_lines]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_prod_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_tp_txs'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_prod_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "date_tx",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "store_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transactions]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_prod_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_tp_tx_lines_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_prod_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_item_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "sku",
                        "type": "nvarchar"
                    },
                    {
                        "name": "qty",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "unit_amt",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transaction_lines_ingest]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_prod_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_tp_txs_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_prod_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "date_tx",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "store_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transactions_ingest]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_prod_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_location_types'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "location-types.csv",
                        "folderPath": {
                            "value": "@concat('location-types/', formatDateTime(utcnow(),'yyyy'), '/', formatDateTime(utcnow(),'MM'), '/', formatDateTime(utcnow(),'dd'))",
                            "type": "Expression"
                        },
                        "container": "[parameters('azure_container_name_staging_ref')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": [
                    {
                        "name": "location_type_id",
                        "type": "String"
                    },
                    {
                        "name": "location_type_name",
                        "type": "String"
                    },
                    {
                        "name": "date_start",
                        "type": "String"
                    },
                    {
                        "name": "date_end",
                        "type": "String"
                    },
                    {
                        "name": "is_deleted",
                        "type": "String"
                    },
                    {
                        "name": "date_created",
                        "type": "String"
                    },
                    {
                        "name": "date_updated",
                        "type": "String"
                    }
                ]
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_locations'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "locations.csv",
                        "folderPath": {
                            "value": "@concat('locations/', formatDateTime(utcnow(),'yyyy'), '/', formatDateTime(utcnow(),'MM'), '/', formatDateTime(utcnow(),'dd'))",
                            "type": "Expression"
                        },
                        "container": "[parameters('azure_container_name_staging_ref')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": [
                    {
                        "name": "location_id",
                        "type": "String"
                    },
                    {
                        "name": "location_type_id",
                        "type": "String"
                    },
                    {
                        "name": "location_name",
                        "type": "String"
                    },
                    {
                        "name": "address_1",
                        "type": "String"
                    },
                    {
                        "name": "address_2",
                        "type": "String"
                    },
                    {
                        "name": "address_3",
                        "type": "String"
                    },
                    {
                        "name": "locality",
                        "type": "String"
                    },
                    {
                        "name": "postal_code",
                        "type": "String"
                    },
                    {
                        "name": "state_province",
                        "type": "String"
                    },
                    {
                        "name": "country",
                        "type": "String"
                    },
                    {
                        "name": "latitude",
                        "type": "String"
                    },
                    {
                        "name": "longitude",
                        "type": "String"
                    },
                    {
                        "name": "date_start",
                        "type": "String"
                    },
                    {
                        "name": "date_end",
                        "type": "String"
                    },
                    {
                        "name": "is_deleted",
                        "type": "String"
                    },
                    {
                        "name": "date_created",
                        "type": "String"
                    },
                    {
                        "name": "date_updated",
                        "type": "String"
                    }
                ]
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_stores'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "stores.csv",
                        "folderPath": {
                            "value": "@concat('stores/', formatDateTime(utcnow(),'yyyy'), '/', formatDateTime(utcnow(),'MM'), '/', formatDateTime(utcnow(),'dd'))",
                            "type": "Expression"
                        },
                        "container": "[parameters('azure_container_name_staging_ref')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": [
                    {
                        "name": "store_id",
                        "type": "String"
                    },
                    {
                        "name": "location_id",
                        "type": "String"
                    },
                    {
                        "name": "store_name",
                        "type": "String"
                    },
                    {
                        "name": "date_start",
                        "type": "String"
                    },
                    {
                        "name": "date_end",
                        "type": "String"
                    },
                    {
                        "name": "is_deleted",
                        "type": "String"
                    },
                    {
                        "name": "date_created",
                        "type": "String"
                    },
                    {
                        "name": "date_updated",
                        "type": "String"
                    }
                ]
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_tx_types'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "tx-types.csv",
                        "folderPath": {
                            "value": "@concat('tx-types/', formatDateTime(utcnow(),'yyyy'), '/', formatDateTime(utcnow(),'MM'), '/', formatDateTime(utcnow(),'dd'))",
                            "type": "Expression"
                        },
                        "container": "[parameters('azure_container_name_staging_ref')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": [
                    {
                        "name": "tx_type_id",
                        "type": "String"
                    },
                    {
                        "name": "tx_type_name",
                        "type": "String"
                    },
                    {
                        "name": "date_start",
                        "type": "String"
                    },
                    {
                        "name": "date_end",
                        "type": "String"
                    },
                    {
                        "name": "is_deleted",
                        "type": "String"
                    },
                    {
                        "name": "date_created",
                        "type": "String"
                    },
                    {
                        "name": "date_updated",
                        "type": "String"
                    }
                ]
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_t_tx_lines'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "transaction-lines.csv",
                        "folderPath": {
                            "value": "@concat('transaction-lines/', formatDateTime(utcnow(),'yyyy'), '/', formatDateTime(utcnow(),'MM'), '/', formatDateTime(utcnow(),'dd'))",
                            "type": "Expression"
                        },
                        "container": "[parameters('azure_container_name_staging_tx')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_t_tx_lines_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "transaction-lines.csv",
                        "folderPath": "transaction-lines/ingest",
                        "container": "[parameters('azure_container_name_staging_tx')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": [
                    {
                        "name": "tx_item_guid",
                        "type": "String"
                    },
                    {
                        "name": "tx_guid",
                        "type": "String"
                    },
                    {
                        "name": "tx_type_id",
                        "type": "String"
                    },
                    {
                        "name": "sku",
                        "type": "String"
                    },
                    {
                        "name": "qty",
                        "type": "String"
                    },
                    {
                        "name": "unit_amt",
                        "type": "String"
                    },
                    {
                        "name": "date_created",
                        "type": "String"
                    },
                    {
                        "name": "date_updated",
                        "type": "String"
                    }
                ]
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_t_txs'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "transactions.csv",
                        "folderPath": {
                            "value": "@concat('transactions/', formatDateTime(utcnow(),'yyyy'), '/', formatDateTime(utcnow(),'MM'), '/', formatDateTime(utcnow(),'dd'))",
                            "type": "Expression"
                        },
                        "container": "[parameters('azure_container_name_staging_tx')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_t_txs_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "transactions.csv",
                        "folderPath": "transactions/ingest",
                        "container": "[parameters('azure_container_name_staging_tx')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": [
                    {
                        "name": "tx_guid",
                        "type": "String"
                    },
                    {
                        "name": "date_tx",
                        "type": "String"
                    },
                    {
                        "name": "store_id",
                        "type": "String"
                    },
                    {
                        "name": "date_created",
                        "type": "String"
                    },
                    {
                        "name": "date_updated",
                        "type": "String"
                    }
                ]
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_op_db_r_location_types'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_on_prem_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "SqlServerTable",
                "schema": [
                    {
                        "name": "location_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_type_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[location_types]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_on_prem_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_op_db_r_locations'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_on_prem_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "SqlServerTable",
                "schema": [
                    {
                        "name": "location_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "address_1",
                        "type": "nvarchar"
                    },
                    {
                        "name": "address_2",
                        "type": "nvarchar"
                    },
                    {
                        "name": "address_3",
                        "type": "nvarchar"
                    },
                    {
                        "name": "locality",
                        "type": "nvarchar"
                    },
                    {
                        "name": "postal_code",
                        "type": "nvarchar"
                    },
                    {
                        "name": "state_province",
                        "type": "nvarchar"
                    },
                    {
                        "name": "country",
                        "type": "nvarchar"
                    },
                    {
                        "name": "latitude",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 8
                    },
                    {
                        "name": "longitude",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 8
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[locations]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_on_prem_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_op_db_r_stores'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_on_prem_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "SqlServerTable",
                "schema": [
                    {
                        "name": "store_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "store_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[stores]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_on_prem_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_op_db_r_tx_types'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_on_prem_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "SqlServerTable",
                "schema": [
                    {
                        "name": "tx_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "tx_type_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[tx_types]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_on_prem_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_op_db_t_tx_lines'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_on_prem_tx_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "SqlServerTable",
                "schema": [
                    {
                        "name": "tx_item_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "tx_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "sku",
                        "type": "nvarchar"
                    },
                    {
                        "name": "qty",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "unit_amt",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 5
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transaction_lines]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_on_prem_tx_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_op_db_t_txs'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_on_prem_tx_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "SqlServerTable",
                "schema": [
                    {
                        "name": "tx_guid",
                        "type": "uniqueidentifier"
                    },
                    {
                        "name": "date_tx",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "store_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[transactions]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_on_prem_tx_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_t_tx_lines_ingest_delete'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureBlob",
                "typeProperties": {
                    "fileName": "[variables('azure_ingest_delete_file_name')]",
                    "folderPath": "[variables('azure_ingest_delete_container_path_tx_lines')]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_t_txs_ingest_delete'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_tx_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureBlob",
                "typeProperties": {
                    "fileName": "[variables('azure_ingest_delete_file_name')]",
                    "folderPath": "[variables('azure_ingest_delete_container_path_txs')]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_tx_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_location_types_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "location-types.csv",
                        "folderPath": "[variables('azure_ingest_delete_folder_path_location_types')]",
                        "container": "[parameters('azure_container_name_staging_ref')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_locations_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "locations.csv",
                        "folderPath": "[variables('azure_ingest_delete_folder_path_locations')]",
                        "container": "[parameters('azure_container_name_staging_ref')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_stores_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "stores.csv",
                        "folderPath": "[variables('azure_ingest_delete_folder_path_stores')]",
                        "container": "[parameters('azure_container_name_staging_ref')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_tx_types_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "DelimitedText",
                "typeProperties": {
                    "location": {
                        "type": "AzureBlobStorageLocation",
                        "fileName": "tx-types.csv",
                        "folderPath": "[variables('azure_ingest_delete_folder_path_tx_types')]",
                        "container": "[parameters('azure_container_name_staging_ref')]"
                    },
                    "columnDelimiter": ",",
                    "escapeChar": "\\",
                    "firstRowAsHeader": true,
                    "quoteChar": "\""
                },
                "schema": []
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_location_types_ingest_delete'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureBlob",
                "typeProperties": {
                    "fileName": "[variables('azure_ingest_delete_file_name')]",
                    "folderPath": "[variables('azure_ingest_delete_container_path_location_types')]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_locations_ingest_delete'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureBlob",
                "typeProperties": {
                    "fileName": "[variables('azure_ingest_delete_file_name')]",
                    "folderPath": "[variables('azure_ingest_delete_container_path_locations')]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_stores_ingest_delete'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureBlob",
                "typeProperties": {
                    "fileName": "[variables('azure_ingest_delete_file_name')]",
                    "folderPath": "[variables('azure_ingest_delete_container_path_stores')]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_st_r_tx_types_ingest_delete'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_storage')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureBlob",
                "typeProperties": {
                    "fileName": "[variables('azure_ingest_delete_file_name')]",
                    "folderPath": "[variables('azure_ingest_delete_container_path_tx_types')]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_storage')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_r_location_types_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "location_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_type_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[location_types_ingest]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_r_locations_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "location_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "address_1",
                        "type": "nvarchar"
                    },
                    {
                        "name": "address_2",
                        "type": "nvarchar"
                    },
                    {
                        "name": "address_3",
                        "type": "nvarchar"
                    },
                    {
                        "name": "locality",
                        "type": "nvarchar"
                    },
                    {
                        "name": "postal_code",
                        "type": "nvarchar"
                    },
                    {
                        "name": "state_province",
                        "type": "nvarchar"
                    },
                    {
                        "name": "country",
                        "type": "nvarchar"
                    },
                    {
                        "name": "latitude",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 8
                    },
                    {
                        "name": "longitude",
                        "type": "decimal",
                        "precision": 18,
                        "scale": 8
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[locations_ingest]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_r_stores_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "store_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "location_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "store_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[stores_ingest]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]"
            ]
        },
        {
            "name": "[concat(parameters('factory_name'), '/', variables('dataset_az_db_r_tx_types_ingest'))]",
            "type": "Microsoft.DataFactory/factories/datasets",
            "apiVersion": "[variables('api_version')]",
            "properties": {
                "linkedServiceName": {
                    "referenceName": "[variables('linked_service_name_azure_ref_data')]",
                    "type": "LinkedServiceReference"
                },
                "annotations": [],
                "type": "AzureSqlTable",
                "schema": [
                    {
                        "name": "tx_type_id",
                        "type": "int",
                        "precision": 10
                    },
                    {
                        "name": "tx_type_name",
                        "type": "nvarchar"
                    },
                    {
                        "name": "date_start",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_end",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "is_deleted",
                        "type": "bit"
                    },
                    {
                        "name": "date_created",
                        "type": "datetime2",
                        "scale": 7
                    },
                    {
                        "name": "date_updated",
                        "type": "datetime2",
                        "scale": 7
                    }
                ],
                "typeProperties": {
                    "tableName": "[[data].[tx_types_ingest]"
                }
            },
            "dependsOn": [
                "[variables('linked_service_id_azure_ref_data')]"
            ]
        }
    ]
}